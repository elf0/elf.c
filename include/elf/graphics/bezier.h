#ifndef BEZIER_H
#define BEZIER_H

//License: Public Domain
//Author: elf
//EMail: elf@iamelf.com

// 65 points
// void DrawBeizer3(U32 p0x, U32 p0y, U32 p1x, U32 p1y, U32 p2x, U32 p2y, U32 p3x, U32 p3y) {
//   U32 x0 = p0x;
//   U32 y0 = p0y;
//   MoveTo(x0, y0);
//   U32 *pC = bezier3_coefficients_16384;
//   U32 *pCR = &bezier3_coefficients_16384[125];
//   U32 *pCEnd = pC + 126;
//   while (pC != pCEnd) {
//     U32 c0 = *pC++;
//     U32 c1 = *pC++;
//     U32 c2 = *pCR--;
//     U32 c3 = *pCR--;
//     U32 x1 = (c0 * p0x + c1 * p1x + c2 * p2x + c3 * p3x) >> 18;
//     U32 y1 = (c0 * p0y + c1 * p1y + c2 * p2y + c3 * p3y) >> 18;
//     LineTo(x0, y0, x1, y1);
//     x0 = x1;
//     y0 = y1;
//   }
//   LineTo(x0, y0, p3x, p3y);
// }
static U32 bezier3_coefficients_16384[126] = {
  250047, 11907, 238328, 23064, 226981, 33489,
  216000, 43200, 205379, 52215, 195112, 60552,
  185193, 68229, 175616, 75264, 166375, 81675,
  157464, 87480, 148877, 92697, 140608, 97344,
  132651, 101439, 125000, 105000, 117649, 108045,
  110592, 110592, 103823, 112659, 97336, 114264,
  91125, 115425, 85184, 116160, 79507, 116487,
  74088, 116424, 68921, 115989, 64000, 115200,
  59319, 114075, 54872, 112632, 50653, 110889,
  46656, 108864, 42875, 106575, 39304, 104040,
  35937, 101277, 32768, 98304, 29791, 95139,
  27000, 91800, 24389, 88305, 21952, 84672,
  19683, 80919, 17576, 77064, 15625, 73125,
  13824, 69120, 12167, 65067, 10648, 60984,
  9261, 56889, 8000, 52800, 6859, 48735,
  5832, 44712, 4913, 40749, 4096, 36864,
  3375, 33075, 2744, 29400, 2197, 25857,
  1728, 22464, 1331, 19239, 1000, 16200,
  729, 13365, 512, 10752, 343, 8379,
  216, 6264, 125, 4425, 64, 2880,
  27, 1647, 8, 744, 1, 189
};

// coefficients c0, c1, c2, c3 from bezier3_coefficients_16384
// control points p0, p1, p2, p3 SHOULD < 16384
inline static
U32 bezier3_16384(U32 c0, U32 p0, U32 c1, U32 p1, U32 c2, U32 p2, U32 c3, U32 p3) {
  return (c0 * p0 + c1 * p1 + c2 * p2 + c3 * p3) >> 18;
}

#endif
